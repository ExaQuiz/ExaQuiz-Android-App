format_version: '11'
default_step_lib_source: https://github.com/bitrise-io/bitrise-steplib.git

project_type: android

workflows:
  deploy:
    steps:
      - git-clone@8: {}

      - install-missing-android-tools@3: {}

      - script@1:
          title: Build Release APK
          inputs:
            - content: |
                #!/bin/bash
                set -ex
                cd ExaQuiz_Android_Codemagic_Ready/android
                chmod +x ./gradlew
                ./gradlew assembleRelease
                ls -lah app/build/outputs/apk/release/

      - script@2:
          title: Move APK to Deploy Folder
          inputs:
            - content: |
                mkdir -p $BITRISE_DEPLOY_DIR
                cp ExaQuiz_Android_Codemagic_Ready/android/app/build/outputs/apk/release/app-release.apk $BITRISE_DEPLOY_DIR

      - deploy-to-bitrise-io@2: {}
